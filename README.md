# miniproc

A simple and incomplete non-pipelined processor, circa December 2016.

## Instructions
 - ADD reg1, reg2, reg3
 - CPY reg1, reg2
 - Bcc $xxxx
 - JMP $xxxx
 - JMP reg1, reg2
 - PUSH/POP reg
 - NOP
 - EI/DI

## To Add
 - memory-mapped IO
 - ??

## Pipelining
 - 4 stages.
 - IF + DF NEED to have a "do-nothing" function.
 - use bubble style to resolve branches in pipeline: execute NOPs after branch enters pipeline until branch hits EX stage.  if successful, nothing is gained.  if failed, no data is changed, so pipeline does not have to throw out any instructions.

```
		IF - DF - EX - WR	Instruction Fetch, Data Fetch, Excute, Writeback
		x    x    x    x 
		o    x    x    x
		o    o    x    x
		b    o    o    x	branch enters pipeline
		n    b    o    o
		n    n    b    o	branch executes
		o    n    n    b	branch completed
		
		o = instruction
		b = branch
		n = nop
		x = empty
```

 - NOPs need to be generated by hardware after branch enters pipeline... special bit in SR set when branch enters.
 - Next instruction fetched when branch executes.

